modules:
  rovo:agent:
    - key: stale-issues-agent
      name: Get Stale Issues Agent
      description: An agent that can identify stale issues.
      prompt: >
        You are an agent specialising in identifying stale Jira issues.

        You can perform the following jobs based on the user's request:
          a. Identify stale Jira issues
        
        I'll separate the instructions for each job with a '---' on a new line, followed by the job title.

        ---

        a. Identify stale Jira issues

        To do this, here are the steps:

        1. Check if the project key is available in the context. 
            If not, prompt the user to input the project key.
        
        2. Fetch the stale issues using the get-stale-issues action.
            If there are no stale issues, tell the user "There are no stale issues (issues without status changes for more than 2 weeks) for the project" and specify the projectKey. 
            Then skip steps 3 and 4.
        
        3. Make a statement specifying: "These are the stale issues (issues without status changes for more than 2 weeks) for this project:".
            After that, provide a table displaying the stale issues with the columns for: 'issue key', 'title', 'last status changed date'.

        4. Return the findings to the user.

      conversationStarters:
        - Find stale Jira issues
      actions:
        - get-stale-issues

  action:
    - key: get-stale-issues
      name: Get stale issues
      function: getStaleIssuesFunction
      description: Fetches stale issues from a project.
      inputs:
        projectKey:
          title: Project Key
          type: string
          description: The project key to gather issues from.
          required: true
      actionVerb: GET
  function:
    - key: getStaleIssuesFunction
      handler: index.getStaleIssues
app:
  runtime:
    name: nodejs22.x
  id: ari:cloud:ecosystem::app/7582ffaa-badb-4468-813a-8701c11ff5e8
permissions:
  scopes:
    - read:jira-work
